{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"E:\\\\ReactProjects\\\\myburger\\\\src\\\\containers\\\\BurgerBuilder\\\\BurgerBuilder.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport { connect, useDispatch, useSelector } from 'react-redux';\nimport Aux from '../../hoc/Auxx/Auxx';\nimport Burger from '../../components/Burger/Burger';\nimport BuildControls from '../../components/Burger/BuildControls/BuildControls';\nimport Modal from '../../components/UI/Modal/Modal';\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\nimport axios from '../../axios-orders';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport withErrorHandler from '../../hoc/WithErrorHandler/withErrorHandler';\nimport * as actions from '../../store/actions/index';\n\nvar burgerBuilder = function burgerBuilder(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      purchasing = _useState2[0],\n      setPurchasing = _useState2[1];\n\n  var dispatch = useDispatch();\n  var ings = useSelector(function (state) {\n    return state.burgerBuilder.ingredients;\n  });\n  var price = useSelector(function (state) {\n    return state.burgerBuilder.totalPrice;\n  });\n  var error = useSelector(function (state) {\n    return state.burgerBuilder.error;\n  });\n  var isAuthenticated = useSelector(function (state) {\n    return state.auth.token !== null;\n  });\n\n  var onIngredientAdded = function onIngredientAdded(ingName) {\n    return dispatch(actions.addIngredient(ingName));\n  };\n\n  var onIngredientRemoved = function onIngredientRemoved(ingName) {\n    return dispatch(actions.removeIngredient(ingName));\n  };\n\n  var onInitIngredients = function onInitIngredients() {\n    return dispatch(actions.initIngredients());\n  };\n\n  var onInitPurchase = function onInitPurchase() {\n    return dispatch(actions.purchaseInit());\n  };\n\n  var onSetAuthRedirectPath = function onSetAuthRedirectPath(path) {\n    return dispatch(actions.setAuthRedirectPath(path));\n  };\n\n  useEffect(function () {\n    onInitIngredients();\n  }, [onInitIngredients]);\n\n  var updatePurchasedState = function updatePurchasedState(ingredients) {\n    var sum = Object.keys(ingredients).map(function (igkey) {\n      return ingredients[igkey];\n    }).reduce(function (sum, el) {\n      return sum + el;\n    }, 0);\n    return sum > 0;\n  };\n\n  var purchaseHandler = function purchaseHandler() {\n    if (props.isAuthenticated) {\n      setPurchasing(true);\n    } else {\n      onSetAuthRedirectPath('/checkout');\n      props.history.push('/auth');\n    }\n  };\n\n  var purchaseCancelHandler = function purchaseCancelHandler() {\n    setPurchasing(false);\n  };\n\n  var purchaseContinueHandler = function purchaseContinueHandler() {\n    onInitPurchase();\n    props.history.push('/checkout');\n  };\n\n  var disabledInfo = _objectSpread({}, props.ings);\n\n  for (var key in disabledInfo) {\n    disabledInfo[key] = disabledInfo[key] <= 0;\n  }\n\n  var orderSummary = null;\n  var burger = props.error ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 32\n    }\n  }, \"Ingredients can`t be loaded!\") : /*#__PURE__*/React.createElement(Spinner, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 68\n    }\n  });\n\n  if (props.ings) {\n    burger = /*#__PURE__*/React.createElement(Aux, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Burger, {\n      ingredients: props.ings,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(BuildControls, {\n      ingredientAdded: onIngredientAdded,\n      ingredientRemoved: onIngredientRemoved,\n      disabled: disabledInfo,\n      purchasable: updatePurchasedState(props.ings),\n      ordered: purchaseHandler,\n      isAuth: props.isAuthenticated,\n      price: props.price,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }\n    }));\n    orderSummary = /*#__PURE__*/React.createElement(OrderSummary, {\n      ingredients: props.ings,\n      price: props.price,\n      purchaseCanceled: purchaseCancelHandler,\n      purchaseContinue: purchaseContinueHandler,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 31\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Aux, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    show: purchasing,\n    modalClosed: purchaseCancelHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 17\n    }\n  }, orderSummary), burger);\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    ings: state.burgerBuilder.ingredients,\n    price: state.burgerBuilder.totalPrice,\n    error: state.burgerBuilder.error,\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    onIngredientAdded: function onIngredientAdded(ingName) {\n      return dispatch(actions.addIngredient(ingName));\n    },\n    onIngredientRemoved: function onIngredientRemoved(ingName) {\n      return dispatch(actions.removeIngredient(ingName));\n    },\n    onInitIngredients: function onInitIngredients() {\n      return dispatch(actions.initIngredients());\n    },\n    onInitPurchase: function onInitPurchase() {\n      return dispatch(actions.purchaseInit());\n    },\n    onSetAuthRedirectPath: function onSetAuthRedirectPath(path) {\n      return dispatch(actions.setAuthRedirectPath(path));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withErrorHandler(burgerBuilder, axios));","map":{"version":3,"sources":["E:/ReactProjects/myburger/src/containers/BurgerBuilder/BurgerBuilder.js"],"names":["React","useState","useEffect","connect","useDispatch","useSelector","Aux","Burger","BuildControls","Modal","OrderSummary","axios","Spinner","withErrorHandler","actions","burgerBuilder","props","purchasing","setPurchasing","dispatch","ings","state","ingredients","price","totalPrice","error","isAuthenticated","auth","token","onIngredientAdded","ingName","addIngredient","onIngredientRemoved","removeIngredient","onInitIngredients","initIngredients","onInitPurchase","purchaseInit","onSetAuthRedirectPath","path","setAuthRedirectPath","updatePurchasedState","sum","Object","keys","map","igkey","reduce","el","purchaseHandler","history","push","purchaseCancelHandler","purchaseContinueHandler","disabledInfo","key","orderSummary","burger","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {connect,useDispatch,useSelector} from 'react-redux';\r\n\r\n\r\nimport Aux from '../../hoc/Auxx/Auxx';\r\nimport Burger from '../../components/Burger/Burger';\r\nimport BuildControls from '../../components/Burger/BuildControls/BuildControls'\r\nimport Modal from '../../components/UI/Modal/Modal';\r\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\r\nimport axios from '../../axios-orders';\r\nimport Spinner from '../../components/UI/Spinner/Spinner';\r\nimport withErrorHandler from '../../hoc/WithErrorHandler/withErrorHandler';\r\nimport * as actions from '../../store/actions/index';\r\n\r\nconst burgerBuilder = props =>{\r\n    const [purchasing,setPurchasing] = useState(false);\r\n    \r\n    const dispatch= useDispatch();\r\n\r\n   const ings= useSelector(state=>{\r\n        return state.burgerBuilder.ingredients;\r\n    });\r\n    const price=useSelector(state=>state.burgerBuilder.totalPrice);\r\n    const error= useSelector(state=>state.burgerBuilder.error);\r\n    const isAuthenticated = useSelector(state=>state.auth.token !==null);\r\n\r\n   const onIngredientAdded = (ingName)=>dispatch(actions.addIngredient(ingName));\r\n   const  onIngredientRemoved = (ingName)=>dispatch(actions.removeIngredient(ingName));\r\n   const onInitIngredients = ()=>dispatch(actions.initIngredients());\r\n  const  onInitPurchase = () => dispatch( actions.purchaseInit());\r\n  const  onSetAuthRedirectPath = (path) =>dispatch(actions.setAuthRedirectPath(path));\r\n\r\n    useEffect(()=>{\r\n        onInitIngredients();\r\n    },[onInitIngredients]);\r\n   \r\n    const updatePurchasedState = (ingredients)=>{\r\n        const sum=Object.keys(ingredients)\r\n        .map(igkey=>{\r\n        return ingredients[igkey];\r\n        }).reduce((sum,el)=>{\r\n            return sum+el;\r\n        },0);\r\n        return sum>0\r\n    }\r\n\r\n   const  purchaseHandler=()=>{\r\n        if(props.isAuthenticated){\r\n            setPurchasing(true);\r\n        }\r\n        else{\r\n         onSetAuthRedirectPath('/checkout'); \r\n         props.history.push('/auth');\r\n        }\r\n        \r\n    }\r\n\r\n   const purchaseCancelHandler=()=>{\r\n        setPurchasing(false);\r\n    }\r\n\r\n    const purchaseContinueHandler=()=>{\r\n        onInitPurchase();\r\n        props.history.push('/checkout');\r\n    }\r\n   \r\n        const disabledInfo={\r\n            ...props.ings\r\n        };\r\n        for(let key in disabledInfo){\r\n            disabledInfo[key]=disabledInfo[key]<=0\r\n        }\r\n\r\n        let orderSummary=null;\r\n        let burger=props.error?<p>Ingredients can`t be loaded!</p>:<Spinner/>\r\n        if(props.ings){\r\n            burger=(\r\n                <Aux>\r\n                <Burger ingredients={props.ings}/>\r\n                <BuildControls \r\n                ingredientAdded={onIngredientAdded}\r\n                ingredientRemoved={onIngredientRemoved}\r\n                disabled={disabledInfo}\r\n                purchasable={updatePurchasedState(props.ings)}\r\n                ordered={purchaseHandler}\r\n                isAuth={props.isAuthenticated}\r\n                price={props.price}/>\r\n                </Aux>\r\n                );\r\n                orderSummary= <OrderSummary \r\n                ingredients={props.ings}\r\n                price={props.price}\r\n                purchaseCanceled={purchaseCancelHandler}\r\n                purchaseContinue={purchaseContinueHandler}/>;\r\n        }\r\n        \r\n        return (\r\n            <Aux>\r\n                <Modal show={purchasing}\r\n                modalClosed={purchaseCancelHandler}>\r\n                   {orderSummary}\r\n                </Modal>\r\n                {burger}\r\n            </Aux>\r\n        )\r\n    };\r\n\r\nconst mapStateToProps=state=>{\r\n    return{\r\n            ings:state.burgerBuilder.ingredients,\r\n            price:state.burgerBuilder.totalPrice,\r\n            error: state.burgerBuilder.error,\r\n            isAuthenticated:state.auth.token !==null\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps=dispatch=>{\r\n    return{\r\n        onIngredientAdded:(ingName)=>dispatch(actions.addIngredient(ingName)),\r\n        onIngredientRemoved:(ingName)=>dispatch(actions.removeIngredient(ingName)),\r\n        onInitIngredients:()=>dispatch(actions.initIngredients()),\r\n        onInitPurchase: () => dispatch( actions.purchaseInit()),\r\n        onSetAuthRedirectPath : (path) =>dispatch(actions.setAuthRedirectPath(path))\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(burgerBuilder,axios));\r\n"]},"metadata":{},"sourceType":"module"}