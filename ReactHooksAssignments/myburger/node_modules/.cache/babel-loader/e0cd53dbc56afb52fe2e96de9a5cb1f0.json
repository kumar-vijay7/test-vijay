{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"E:\\\\ReactProjects\\\\myburger\\\\src\\\\containers\\\\BurgerBuilder\\\\BurgerBuilder.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport Aux from '../../hoc/Auxx/Auxx';\nimport Burger from '../../components/Burger/Burger';\nimport BuildControls from '../../components/Burger/BuildControls/BuildControls';\nimport Modal from '../../components/UI/Modal/Modal';\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\nimport axios from '../../axios-orders';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport withErrorHandler from '../../hoc/WithErrorHandler/withErrorHandler';\nimport * as actions from '../../store/actions/index';\n\nvar burgerBuilder = function burgerBuilder(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      purchasing = _useState2[0],\n      setPurchasing = _useState2[1];\n\n  var onInitIngredients = props.onInitIngredients;\n  useEffect(function () {\n    onInitIngredients();\n  }, [onInitIngredients]);\n\n  var updatePurchasedState = function updatePurchasedState(ingredients) {\n    var sum = Object.keys(ingredients).map(function (igkey) {\n      return ingredients[igkey];\n    }).reduce(function (sum, el) {\n      return sum + el;\n    }, 0);\n    return sum > 0;\n  };\n\n  var purchaseHandler = function purchaseHandler() {\n    if (props.isAuthenticated) {\n      setPurchasing(true);\n    } else {\n      props.onSetAuthRedirectPath('/checkout');\n      props.history.push('/auth');\n    }\n  };\n\n  var purchaseCancelHandler = function purchaseCancelHandler() {\n    setPurchasing(false);\n  };\n\n  var purchaseContinueHandler = function purchaseContinueHandler() {\n    props.onInitPurchase();\n    props.history.push('/checkout');\n  };\n\n  var disabledInfo = _objectSpread({}, props.ings);\n\n  for (var key in disabledInfo) {\n    disabledInfo[key] = disabledInfo[key] <= 0;\n  }\n\n  var orderSummary = null;\n  var burger = props.error ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 32\n    }\n  }, \"Ingredients can`t be loaded!\") : /*#__PURE__*/React.createElement(Spinner, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 68\n    }\n  });\n\n  if (props.ings) {\n    burger = /*#__PURE__*/React.createElement(Aux, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Burger, {\n      ingredients: props.ings,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(BuildControls, {\n      ingredientAdded: props.onIngredientAdded,\n      ingredientRemoved: props.onIngredientRemoved,\n      disabled: disabledInfo,\n      purchasable: updatePurchasedState(props.ings),\n      ordered: purchaseHandler,\n      isAuth: props.isAuthenticated,\n      price: props.price,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }\n    }));\n    orderSummary = /*#__PURE__*/React.createElement(OrderSummary, {\n      ingredients: props.ings,\n      price: props.price,\n      purchaseCanceled: purchaseCancelHandler,\n      purchaseContinue: purchaseContinueHandler,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 31\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Aux, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    show: purchasing,\n    modalClosed: purchaseCancelHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 17\n    }\n  }, orderSummary), burger);\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    ings: state.burgerBuilder.ingredients,\n    price: state.burgerBuilder.totalPrice,\n    error: state.burgerBuilder.error,\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    onIngredientAdded: function onIngredientAdded(ingName) {\n      return dispatch(actions.addIngredient(ingName));\n    },\n    onIngredientRemoved: function onIngredientRemoved(ingName) {\n      return dispatch(actions.removeIngredient(ingName));\n    },\n    onInitIngredients: function onInitIngredients() {\n      return dispatch(actions.initIngredients());\n    },\n    onInitPurchase: function onInitPurchase() {\n      return dispatch(actions.purchaseInit());\n    },\n    onSetAuthRedirectPath: function onSetAuthRedirectPath(path) {\n      return dispatch(actions.setAuthRedirectPath(path));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withErrorHandler(burgerBuilder, axios));","map":{"version":3,"sources":["E:/ReactProjects/myburger/src/containers/BurgerBuilder/BurgerBuilder.js"],"names":["React","useState","useEffect","connect","Aux","Burger","BuildControls","Modal","OrderSummary","axios","Spinner","withErrorHandler","actions","burgerBuilder","props","purchasing","setPurchasing","onInitIngredients","updatePurchasedState","ingredients","sum","Object","keys","map","igkey","reduce","el","purchaseHandler","isAuthenticated","onSetAuthRedirectPath","history","push","purchaseCancelHandler","purchaseContinueHandler","onInitPurchase","disabledInfo","ings","key","orderSummary","burger","error","onIngredientAdded","onIngredientRemoved","price","mapStateToProps","state","totalPrice","auth","token","mapDispatchToProps","dispatch","ingName","addIngredient","removeIngredient","initIngredients","purchaseInit","path","setAuthRedirectPath"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {connect} from 'react-redux';\r\nimport Aux from '../../hoc/Auxx/Auxx';\r\nimport Burger from '../../components/Burger/Burger';\r\nimport BuildControls from '../../components/Burger/BuildControls/BuildControls'\r\nimport Modal from '../../components/UI/Modal/Modal';\r\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary';\r\nimport axios from '../../axios-orders';\r\nimport Spinner from '../../components/UI/Spinner/Spinner';\r\nimport withErrorHandler from '../../hoc/WithErrorHandler/withErrorHandler';\r\nimport * as actions from '../../store/actions/index';\r\n\r\nconst burgerBuilder = props =>{\r\n    const [purchasing,setPurchasing] = useState(false);\r\n    \r\n    const {onInitIngredients} = props;\r\n    useEffect(()=>{\r\n        onInitIngredients();\r\n    },[onInitIngredients]);\r\n   \r\n    const updatePurchasedState = (ingredients)=>{\r\n        const sum=Object.keys(ingredients)\r\n        .map(igkey=>{\r\n        return ingredients[igkey];\r\n        }).reduce((sum,el)=>{\r\n            return sum+el;\r\n        },0);\r\n        return sum>0\r\n    }\r\n\r\n   const  purchaseHandler=()=>{\r\n        if(props.isAuthenticated){\r\n            setPurchasing(true);\r\n        }\r\n        else{\r\n         props.onSetAuthRedirectPath('/checkout'); \r\n         props.history.push('/auth');\r\n        }\r\n        \r\n    }\r\n\r\n   const purchaseCancelHandler=()=>{\r\n        setPurchasing(false);\r\n    }\r\n\r\n    const purchaseContinueHandler=()=>{\r\n        props.onInitPurchase();\r\n        props.history.push('/checkout');\r\n    }\r\n   \r\n        const disabledInfo={\r\n            ...props.ings\r\n        };\r\n        for(let key in disabledInfo){\r\n            disabledInfo[key]=disabledInfo[key]<=0\r\n        }\r\n\r\n        let orderSummary=null;\r\n        let burger=props.error?<p>Ingredients can`t be loaded!</p>:<Spinner/>\r\n        if(props.ings){\r\n            burger=(\r\n                <Aux>\r\n                <Burger ingredients={props.ings}/>\r\n                <BuildControls \r\n                ingredientAdded={props.onIngredientAdded}\r\n                ingredientRemoved={props.onIngredientRemoved}\r\n                disabled={disabledInfo}\r\n                purchasable={updatePurchasedState(props.ings)}\r\n                ordered={purchaseHandler}\r\n                isAuth={props.isAuthenticated}\r\n                price={props.price}/>\r\n                </Aux>\r\n                );\r\n                orderSummary= <OrderSummary \r\n                ingredients={props.ings}\r\n                price={props.price}\r\n                purchaseCanceled={purchaseCancelHandler}\r\n                purchaseContinue={purchaseContinueHandler}/>;\r\n        }\r\n        \r\n        return (\r\n            <Aux>\r\n                <Modal show={purchasing}\r\n                modalClosed={purchaseCancelHandler}>\r\n                   {orderSummary}\r\n                </Modal>\r\n                {burger}\r\n            </Aux>\r\n        )\r\n    };\r\n\r\nconst mapStateToProps=state=>{\r\n    return{\r\n            ings:state.burgerBuilder.ingredients,\r\n            price:state.burgerBuilder.totalPrice,\r\n            error: state.burgerBuilder.error,\r\n            isAuthenticated:state.auth.token !==null\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps=dispatch=>{\r\n    return{\r\n        onIngredientAdded:(ingName)=>dispatch(actions.addIngredient(ingName)),\r\n        onIngredientRemoved:(ingName)=>dispatch(actions.removeIngredient(ingName)),\r\n        onInitIngredients:()=>dispatch(actions.initIngredients()),\r\n        onInitPurchase: () => dispatch( actions.purchaseInit()),\r\n        onSetAuthRedirectPath : (path) =>dispatch(actions.setAuthRedirectPath(path))\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(burgerBuilder,axios));\r\n"]},"metadata":{},"sourceType":"module"}